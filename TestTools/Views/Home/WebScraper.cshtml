@{
    ViewData["Title"] = "Web Scrape Tool";
}

<link rel="stylesheet" href="~/css/site.css" />

<div class="container-fluid px-2 px-md-4 py-3">
    <div class="card w-100 my-4">
        <div class="card-header bg-primary text-white">
            <h2 class="mb-0 text-center"><i class="fas fa-globe me-2"></i>Web Scrape Tool</h2>
        </div>
        <div class="card-body p-3 p-md-4">
            <p class="mb-3 text-center">Scrape web elements from specified URLs for automation testing. Add web addresses, start scraping, and review the extracted elements.</p>
            <!-- URL Input Section -->
            <div class="card my-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0 text-center"><i class="fas fa-plus-circle me-2"></i>Add Web Addresses</h5>
                </div>
                <div class="card-body">
                    <div class="input-group mb-3">
                        <input type="text" id="urlInput" class="form-control" placeholder="Enter web address..." aria-label="Enter web address">
                        <button class="btn btn-outline-secondary" type="button" id="addUrlBtn"><i class="fas fa-plus"></i> Add URL</button>
                    </div>
                    <div id="urlValidationFeedback" class="feedback-text"></div>
                    <div class="mt-3">
                        <label class="form-label">URLs to Scrape:</label>
                        <ul id="urlList" class="list-group">
                            <!-- URLs will be added here -->
                        </ul>
                        <div id="noUrlsMessage" class="text-muted mt-2">No URLs added yet. Add at least one URL to scrape.</div>
                    </div>
                    <div class="d-grid gap-2 mt-3">
                        <button id="scrapeBtn" class="btn btn-primary flex-fill" disabled>
                            <i class="fas fa-play"></i> Scrape Web Pages
                        </button>
                    </div>
                </div>
            </div>
            <!-- Results Section -->
            <div id="resultsSection" class="card d-none">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Scraped Web Elements</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <div class="row g-2 align-items-center">
                            <div class="col-md-6">
                                <div class="btn-group" role="group">
                                    <button id="selectAllBtn" class="btn btn-sm btn-outline-primary"><i class="fas fa-check-square me-1"></i> Select All</button>
                                    <button id="deselectAllBtn" class="btn btn-sm btn-outline-secondary"><i class="fas fa-square me-1"></i> Deselect All</button>
                                </div>
                            </div>
                            <small class="text-muted"><i class="fas fa-info-circle me-1"></i>
                                XPath columns are hidden on smaller screens for better readability. Use the Generate POM button to access full XPath data.
                            </small>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table id="elementsTable" class="table table-striped table-hover table-sm">
                            <thead>
                                <tr>
                                    <th style="width: 50px; min-width: 50px;">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="selectAll">
                                        </div>
                                    </th>
                                    <th style="min-width: 120px;">Name</th>
                                    <th style="min-width: 100px;">Id</th>
                                    <th style="min-width: 200px;" class="d-none d-lg-table-cell">Relative XPath</th>
                                    <th style="min-width: 250px;" class="d-none d-xl-table-cell">Full XPath</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Elements will be added here -->
                            </tbody>
                        </table>
                    </div>
                    <!-- Mobile-friendly XPath display -->
                    <div class="d-lg-none mt-3">
                    </div>
                </div>
            </div>
            <!-- Actions Sub-Card (now inside main card-body, at the bottom) -->
            <div class="card mt-4">
                <div class="card-header bg-primary text-white text-center">
                    <h5 class="mb-0 text-center"><i class="fas fa-tools"></i> Actions</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <button id="generatePOMBtn" class="btn btn-primary flex-fill" disabled><i class="fas fa-file-code me-1"></i> Generate POM</button>
                    </div>
                </div>
            </div>
            <!-- Loading Spinner -->
            <div id="loadingSpinner" class="d-none">
                <div class="d-flex justify-content-center my-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
                <p class="text-center text-muted">Scraping web elements, please wait...</p>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script src="/js/webScraper.js"></script>
}
